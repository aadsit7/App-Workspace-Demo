<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Recast — Compact Click-Through (Realistic Catalog)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="dark light" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://unpkg.com" />
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- IMPORTANT: lottie-player web component does NOT guarantee a global `lottie` object.
         If you call lottie.loadAnimation(...) you must load lottie-web. -->
    <script src="https://unpkg.com/lottie-web@5.12.2/build/player/lottie.min.js"></script>
    <style>
      /* ------------------------------
         Keyframes (defined in CSS so animations work
         even if Tailwind JIT doesn't generate them)
         ------------------------------ */
      @keyframes tilePulse {
        0% {
          transform: scale(0.7);
          background-color: #e5e7eb;
          opacity: 0.4;
        }
        60% {
          transform: scale(1);
          background-color: #2563eb;
          opacity: 1;
        }
        100% {
          background-color: #e5e7eb;
          opacity: 0.9;
        }
      }
      @keyframes barGrow {
        to {
          transform: scaleX(1);
        }
      }
      @keyframes boltDrop {
        to {
          transform: scaleY(1);
        }
      }
      @keyframes appLiftPulse {
        0% {
          transform: translateY(0) scale(1);
          filter: saturate(0.4);
          opacity: 0.65;
        }
        30% {
          transform: translateY(-4px) scale(1.05);
        }
        60% {
          transform: translateY(-2px) scale(1.02);
          filter: saturate(1);
          opacity: 1;
        }
        100% {
          transform: translateY(0) scale(1);
        }
      }
      @keyframes badgeDrop {
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }
      @keyframes fadeInOut {
        0% {
          opacity: 0;
        }
        30% {
          opacity: 1;
        }
        70% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes iconLaunch {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }
      @keyframes fadeIn {
        to {
          opacity: 1;
        }
      }
      @keyframes modalEnter {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      @keyframes overlayFade {
        0% {
          opacity: 0;
        }
        100% {
          opacity: 1;
        }
      }
      /* ------------------------------
         Lightweight “framework” hooks:
         Toggle ONE class (.run) on a container
         and everything tagged with [data-anim] runs.
         Portable to other experiences.
         ------------------------------ */
      .run [data-anim="tilePulse"] {
        animation: tilePulse 1s ease-in-out var(--d, 0s) 1 forwards;
      }
      .run [data-anim="barGrow"] {
        animation: barGrow 0.9s ease forwards var(--d, 0s);
      }
      .run [data-anim="boltDrop"] {
        animation: boltDrop 0.9s ease forwards var(--d, 0s);
      }
      .run [data-anim="fadeInOut"] {
        animation: fadeInOut 1.5s ease var(--d, 0s) forwards;
      }
      .run [data-anim="badgeDrop"] {
        animation: badgeDrop 0.8s ease-out var(--d, 0s) forwards;
      }
      /* ------------------------------
         Overlay sits on top of the Application Workspace card
         ------------------------------ */
      #recast-approach-animation-layer {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 999;
      }
      #recast-approach-animation-layer .lottie {
        position: absolute;
        width: 100%;
        height: 100%;
        display: none;
      }
      /* Final calm state after animation (scoped to the flow card, not the whole page) */
      #flowCard.workspace-final .warning,
      #flowCard.workspace-final .duplicate,
      #flowCard.workspace-final .loading-indicator {
        opacity: 0;
        transition: opacity 0.25s ease-out;
      }
      #flowCard.workspace-final .app-icon {
        opacity: 1;
        transform: scale(1);
        transition: 0.25s ease-out;
      }
      .dimmed {
        opacity: 0.5;
        transition: opacity 0.3s ease;
      }
      .highlighted {
        border-color: #10b981;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3);
        transition: all 0.3s ease;
      }
      .processed {
        background-color: #ecfdf5 !important;
        border-color: #d1fae5 !important;
        color: #065f46 !important;
        transition: all 0.3s ease;
      }
      /* Modal animation helpers (no Tailwind dependency) */
      .animate-modalEnter {
        animation: modalEnter 300ms cubic-bezier(0.2, 0.8, 0.2, 1);
      }
      .animate-overlayFade {
        animation: overlayFade 300ms ease;
      }
      .animate-fadeInOut {
        animation: fadeInOut 1.5s ease var(--d, 0s) forwards;
      }
      .animate-fadeIn {
        animation: fadeIn 1s ease 10s forwards;
      }
      .animate-iconLaunch {
        animation: iconLaunch 0.5s ease forwards;
      }

      /* ------------------------------
         NEW: delivery visuals (motorcycle + chip)
         These are hidden when the end user is delivered apps.
         ------------------------------ */
      #deliveryRider,
      #deliveryMotionChip {
        transition: opacity 220ms ease, transform 220ms ease;
      }
    </style>
  </head>
  <body class="min-h-screen antialiased bg-gray-50 text-gray-900 font-[Inter]">
    <div id="app" class="min-h-screen"></div>
    <script>
      /* =========================
         STATE + CONSTANTS
         ========================= */
      const STATE = {
        activeTab: "problems",
        activeView: "exec",
        impact: { minutes: 9, pkgHours: 6, riskHrs: 22.5 },
        defaults: { impact: { minutes: 9, pkgHours: 6, riskHrs: 22.5 } },
        ctx: { device: "Windows", network: "Corporate", compliant: true },
        packHrs: 8,
        configHrs: 2,
        currentHrs: 24,
        roiInputs: { users: 5000, ticketsPerUserPerMonth: 0.035, avgHandleMins: 18 },
        copied: false,
        showLabels: false,
        showSolutionCards: true,
        openWhy: null,
        openWhyModal: null,
        openCards: { core: false, onboarding: false, trust: false },
        visitedCards: [],
        openBuckets: { one: false, zero: false, per: false, edit: false },
        modalOpen: false,
        editBuffers: {
          change: { intro: "", bullets: "", analyst: "" },
          now: { intro: "", bullets: "", analyst: "" },
          recast: { intro: "", bullets: "", analyst: "" },
        },
        selectedBullets: {},
        currentState: {
          change: {
            intro:
              "The app layer has become the biggest slowdown in IT. Teams are drowning in apps, constant updates, and one-off fixes, and every project ends up paying the price.",
            bullets: [
              "There are too many apps to manage by hand. Commercial, internal, and legacy software are spread across Intune, ConfigMgr, VDI, Windows, and macOS.",
              "Headcount hasn’t grown, but the work has exploded. Most teams are already over capacity and spend most of their day reacting to app issues.",
              "Big initiatives keep getting stuck. Cloud moves, Citrix or AVD projects, hardware refreshes, and AI efforts all run into the same wall — app readiness.",
              "Technical debt keeps piling up. Different versions of the same app are everywhere, creating more risk, more tickets, and slower recovery when things break.",
            ],
            analyst:
              "When the application layer is a mess, transformation projects stall or fail. It’s not because the strategy is wrong, but because there’s no capacity left to execute.",
          },
          now: {
            intro:
              "IT teams are being asked to manage more apps and more change with the same people and the same tools. The gap between what’s expected and what’s possible keeps getting wider.",
            bullets: [
              "App updates and complexity keep increasing, but team size stays the same. You can’t scale people the way you scale software.",
              "Internal and custom apps don’t update themselves, so every change adds more manual work, more dependencies, and more risk.",
              "Leadership wants progress on AI, modernization, and new platforms, but the teams who could drive that progress are stuck keeping apps running.",
              "The longer this goes on, the worse it gets. Version sprawl grows, security and compliance get harder, and cleanup costs rise fast.",
            ],
            analyst:
              "In the next few years, the organizations that succeed with AI and modernization will be the ones that fix app delivery first. Everyone else will hit a hard capacity wall.",
          },
          recast: {
            intro:
              "Recast’s Application Workspace solves the core problem. It gives IT one place to package, update, and manage every application so the app layer stops slowing everything down.",
            bullets: [
              "One workspace for every app, whether commercial, internal, or legacy. Installs, updates, and access all handled consistently across Intune, ConfigMgr, AVD, and other systems.",
              "Automates what teams still do by hand — packaging, versioning, and pushing updates, especially for internal and custom apps.",
              "Reduces technical debt and version sprawl, which means fewer variables when something breaks and far fewer app-related tickets.",
              "Frees up IT capacity. What used to take hours now takes minutes, so migrations, pilots, patch cycles, and AI projects can finally move at business speed.",
            ],
            analyst:
              "Recast turns app management from a drag on every project into a stable foundation. Readiness stops being the blocker and becomes the default.",
          },
        },
        defaultsCurrentState() {
          return JSON.parse(
            JSON.stringify({
              change: {
                intro:
                  "The app layer has become the biggest slowdown in IT. Teams are drowning in apps, constant updates, and one-off fixes, and every project ends up paying the price.",
                bullets: [
                  "There are too many apps to manage by hand. Commercial, internal, and legacy software are spread across Intune, ConfigMgr, VDI, Windows, and macOS.",
                  "Headcount hasn’t grown, but the work has exploded. Most teams are already over capacity and spend most of their day reacting to app issues.",
                  "Big initiatives keep getting stuck. Cloud moves, Citrix or AVD projects, hardware refreshes, and AI efforts all run into the same wall — app readiness.",
                  "Technical debt keeps piling up. Different versions of the same app are everywhere, creating more risk, more tickets, and slower recovery when things break.",
                ],
                analyst:
                  "When the application layer is a mess, transformation projects stall or fail. It’s not because the strategy is wrong, but because there’s no capacity left to execute.",
              },
              now: {
                intro:
                  "IT teams are being asked to manage more apps and more change with the same people and the same tools. The gap between what’s expected and what’s possible keeps getting wider.",
                bullets: [
                  "App updates and complexity keep increasing, but team size stays the same. You can’t scale people the way you scale software.",
                  "Internal and custom apps don’t update themselves, so every change adds more manual work, more dependencies, and more risk.",
                  "Leadership wants progress on AI, modernization, and new platforms, but the teams who could drive that progress are stuck keeping apps running.",
                  "The longer this goes on, the worse it gets. Version sprawl grows, security and compliance get harder, and cleanup costs rise fast.",
                ],
                analyst:
                  "In the next few years, the organizations that succeed with AI and modernization will be the ones that fix app delivery first. Everyone else will hit a hard capacity wall.",
              },
              recast: {
                intro:
                  "Recast’s Application Workspace solves the core problem. It gives IT one place to package, update, and manage every application so the app layer stops slowing everything down.",
                bullets: [
                  "One workspace for every app, whether commercial, internal, or legacy. Installs, updates, and access all handled consistently across Intune, ConfigMgr, AVD, and other systems.",
                  "Automates what teams still do by hand — packaging, versioning, and pushing updates, especially for internal and custom apps.",
                  "Reduces technical debt and version sprawl, which means fewer variables when something breaks and far fewer app-related tickets.",
                  "Frees up IT capacity. What used to take hours now takes minutes, so migrations, pilots, patch cycles, and AI projects can finally move at business speed.",
                ],
                analyst:
                  "Recast turns app management from a drag on every project into a stable foundation. Readiness stops being the blocker and becomes the default.",
              },
            })
          );
        },
        progress: { apps: 0, time: 0, tickets: 0 },
      };
      const TABS = [
        { id: "problems", label: "Current State", icon: "alert-triangle" },
        { id: "solution", label: "Recast Approach", icon: "workflow" },
        { id: "roi", label: "Business Impact", icon: "bar-chart-3" },
      ];
      const NEW_CARDS = [
        {
          id: "core",
          icon: "layers",
          title: "How Recast Does It.",
          bullets: [
            "One workspace to package, deploy, update, and retire apps across Intune, SCCM, Citrix, Omnissa, and Azure.",
            "8,000+ pre-tested enterprise apps ready to deploy instantly.",
            "Automated patching and validation keep apps secure and compliant.",
            "Unified dashboard for visibility and governance across all environments.",
            "Policy-driven automation reduces manual work by over 60%.",
            "End users get the right app instantly — no tickets, no delays.",
          ],
          closer: "Configured once — Delivered everywhere.",
          timeline: false,
          bgHeader: "bg-gray-50",
          bgContent: "bg-gray-50",
        },
        {
          id: "onboarding",
          icon: "clock",
          title: "Onboard & Up to Speed Fast.",
          bullets: [
            "Standard rollout in 4–6 weeks (Kickoff — Implementation — UAT — Launch — Enablement).",
            "No new infrastructure — integrates with your existing management tools.",
            "Guided setup with dedicated Customer Success Manager.",
            "Typical resource: 1–2 IT engineers part-time.",
            "Enablement includes training, certification, and success planning.",
          ],
          closer: "From first call to production in weeks, not months.",
          timeline: true,
          bgHeader: "bg-gray-50",
          bgContent: "bg-gray-50",
        },
        {
          id: "trust",
          icon: "shield-check",
          title: "Trusted by Customers",
          bullets: [
            "60M+ endpoints across 130+ countries.",
            "70k+ Customers & Trusted by global organizations| Citibank, McKinsey & Company, U.S. Air Force, FEMA, Hitachi, Johns Hopkins, Costco, Government of Canada.",
            "87 CSAT Score | Most trusted in the industry",
            "Proven scalability from small pilots to global deployments.",
            "Backed by enterprise-grade support and compliance alignment (SOC 2, ISO 27001).",
          ],
          closer: "Trusted by organizations that can’t afford downtime.",
          timeline: false,
          bgHeader: "bg-gray-50",
          bgContent: "bg-gray-50",
        },
      ];
      const onboardingMiniTimelineEnabled = true;
      function cx(...a) {
        return a.filter(Boolean).join(" ");
      }
      function round(n) {
        return Math.round(n * 100) / 100;
      }
      function num(n) {
        return new Intl.NumberFormat().format(Math.round(n));
      }
      function routeRecommendation(ctx) {
        if (!ctx.compliant) return "Web";
        if (ctx.device === "Windows" && ctx.network !== "Home") return "Local";
        return "VDI";
      }
      function cleanNum(v) {
        v = Number(String(v).replace(/[^0-9.\-]/g, ""));
        return isFinite(v) ? v : 0;
      }

      /* =========================
         LOTTIE OVERLAY (FIXED)
         - Initialize ONLY after the Solution tab is rendered.
         - Destroy on re-render to avoid stale DOM references.
         ========================= */
      let approachAnimations = null;
      let approachTimeouts = [];
      const LOTTIE_PATHS = {
        chaos: "https://assets4.lottiefiles.com/packages/lf20_yr6zz3wt.json",
        collapse: "https://assets3.lottiefiles.com/packages/lf20_k9qliiD3Bf.json",
        unify: "https://assets1.lottiefiles.com/packages/lf20_u4yrau.json",
        endstate: "https://assets8.lottiefiles.com/packages/lf20_jmejybvu.json",
      };
      function clearApproachTimeouts() {
        approachTimeouts.forEach((t) => clearTimeout(t));
        approachTimeouts = [];
      }
      function destroyApproachAnimations() {
        clearApproachTimeouts();
        if (!approachAnimations) return;
        Object.values(approachAnimations).forEach((anim) => {
          try {
            anim.destroy();
          } catch {}
        });
        approachAnimations = null;
      }
      function ensureApproachAnimations() {
        if (!window.lottie) return; // lottie-web not loaded
        const layer = document.getElementById("recast-approach-animation-layer");
        if (!layer) return; // not in DOM (not on Solution tab)
        const ids = Object.keys(LOTTIE_PATHS);
        // If this is a fresh DOM, create animations.
        approachAnimations = approachAnimations || {};
        for (const id of ids) {
          const el = document.getElementById(id);
          if (!el) return;
          if (approachAnimations[id]) continue;
          approachAnimations[id] = window.lottie.loadAnimation({
            container: el,
            renderer: "svg",
            autoplay: false,
            loop: false,
            path: LOTTIE_PATHS[id],
          });
        }
      }
      function hideApproachLayers() {
        ["chaos", "collapse", "unify", "endstate"].forEach((id) => {
          const el = document.getElementById(id);
          if (el) el.style.display = "none";
        });
      }
      function playStep(name, delay) {
        approachTimeouts.push(
          setTimeout(() => {
            if (!approachAnimations || !approachAnimations[name]) return;
            const layer = document.getElementById(name);
            if (!layer) return;
            layer.style.display = "block";
            try {
              approachAnimations[name].goToAndPlay(0, true);
            } catch {}
          }, delay)
        );
      }
      function runWorkspaceAnimation() {
        ensureApproachAnimations();
        hideApproachLayers();
        clearApproachTimeouts();
        const flowCard = document.getElementById("flowCard");
        if (flowCard) flowCard.classList.remove("workspace-final");
        playStep("chaos", 0);
        playStep("collapse", 1000);
        playStep("unify", 2000);
        playStep("endstate", 10000);
        approachTimeouts.push(
          setTimeout(() => {
            const fc = document.getElementById("flowCard");
            if (fc) fc.classList.add("workspace-final");
          }, 11000)
        );
      }

      /* =========================
         RENDER
         ========================= */
      function render() {
        // If we’re about to re-render, destroy lottie animations tied to old DOM nodes.
        destroyApproachAnimations();
        const root = document.getElementById("app");
        root.innerHTML = `
          <header class="relative">
            <div class="relative mx-auto max-w-6xl px-6 lg:px-12 pt-8 pb-6">
              <h1 class="text-4xl md:text-5xl font-semibold leading-tight"><span class="text-blue-600">Re</span><span class="text-gray-900">cast Application Workspace</span></h1>
              <p class="mt-2 max-w-2xl text-base leading-relaxed text-gray-700">
                ${
                  STATE.activeTab === "problems"
                    ? ""
                    : "Recast works across SCCM, Intune, Citrix, VMware Workspace ONE, and more—making the tools you already use faster, smarter, and easier to manage"
                }
              </p>
            </div>
            <div class="relative mx-auto max-w-6xl px-6 lg:px-12">
              <div role="tablist" aria-label="Demo sections" class="flex flex-nowrap overflow-x-auto gap-2 rounded bg-gray-50 p-1 ring-1 ring-gray-200">
                ${TABS.map(
                  (t) => `
                  <button type="button" class="${cx(
                    "flex-1 inline-flex items-center justify-center gap-2 px-3.5 py-1.5 text-sm focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 transition rounded-full",
                    STATE.activeTab === t.id
                      ? "bg-blue-600 text-white hover:bg-blue-700"
                      : "text-gray-900 hover:bg-gray-100"
                  )}" data-action="switch-tab" data-tab="${t.id}" aria-controls="panel-${t.id}" aria-selected="${
                    STATE.activeTab === t.id
                  }">
                    <i data-lucide="${t.icon}" class="w-4 h-4"></i><span>${t.label}</span>
                  </button>
                `
                ).join("")}
              </div>
            </div>
          </header>
          <main class="mx-auto max-w-6xl px-6 lg:px-12 pb-8 gap-4">
            <section class="mt-4">${renderActivePanel()}</section>
          </main>
          ${renderModal()}
          ${renderWhyModal()}
        `;
        if (window.lucide?.createIcons) {
          try {
            window.lucide.createIcons();
          } catch {}
        }
        attachEvents();
        if (STATE.activeTab === "solution") {
          buildFlow();
          ensureApproachAnimations(); // now that DOM exists
        }
        if (STATE.activeTab === "roi") {
          updateROIOutputs();
        }
        if (STATE.activeTab === "solution") {
          attachAccordionKeyboardOnce();
        }
      }
      function renderActivePanel() {
        if (STATE.activeTab === "problems") return renderProblems();
        if (STATE.activeTab === "solution") return renderSolution();
        if (STATE.activeTab === "roi") return renderROI();
        return "";
      }

      /* =========================
         CURRENT STATE (PROBLEMS TAB)
         ========================= */
      const pressures = [
        {
          id: "cost",
          title: "CAPACITY & OPERATIONAL DRAG",
          bullets: [
            "Manual app management consumes skilled IT capacity.",
            "Redundant installs create rework and escalation.",
            "Teams can’t scale delivery as application demand increases.",
            "Lack of standardization hides friction across the lifecycle.",
          ],
        },
        {
          id: "risk",
          title: "RISK, COMPLIANCE & SECURITY",
          bullets: [
            "Version sprawl and patch gaps increase organizational risk.",
            "No unified view limits governance and response speed.",
            "Manual processes increase human error and audit exposure.",
          ],
        },
        {
          id: "capacity",
          title: "CAPACITY & DELIVERY VELOCITY",
          bullets: [
            "Flat headcount limits the pace of change.",
            "Repetitive tasks crowd out modernization efforts.",
            "App readiness issues stall critical initiatives.",
          ],
        },
        {
          id: "employee",
          title: "EMPLOYEE EXPERIENCE & ENABLEMENT",
          bullets: [
            "App delays stall workflows and frustrate users.",
            "Version mismatches break processes and erode IT trust.",
            "Inconsistent delivery drives shadow IT and ticket volume.",
          ],
        },
      ];
      function renderProblems() {
        return `
          <section id="panel-problems" class="space-y-3">
            <h2 class="text-3xl font-semibold leading-tight">The application layer is the #1 bottleneck to operational change.</h2>
            <p class="text-base text-gray-700 leading-relaxed">Most IT teams aren’t failing — they’re constrained by a delivery model that doesn’t scale with the pace of change.</p>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 items-start">
              ${pressures
                .map(
                  (p) => `
                <div class="rounded-2xl bg-white shadow-md hover:shadow-lg hover:-translate-y-[2px] transition-shadow duration-300 transition-transform p-4 flex flex-col space-y-1 h-full">
                  <h3 class="text-[14px] font-semibold mb-1">${p.title}</h3>
                  <ul class="list-disc list-inside space-y-1 text-[12px] text-gray-700">
                    ${p.bullets
                      .map((b, i) => {
                        const selected = (STATE.selectedBullets[p.id] || []).includes(i);
                        return `
                        <li class="flex items-center gap-2 min-h-[1.25rem] ${
                          selected ? "bg-blue-50 rounded-md p-1 transition-colors" : ""
                        } ${b ? "" : "invisible"}">
                          <label class="flex items-center gap-2 cursor-pointer select-none w-full">
                            <input type="checkbox" class="sr-only" data-action="toggle-bullet" data-category="${p.id}" data-index="${i}" ${
                          selected ? "checked" : ""
                        } aria-label="Select: ${b}">
                            <div class="w-3.5 h-3.5 border-2 rounded-full flex items-center justify-center transition-all duration-200 ease-in-out shrink-0 ${
                              selected ? "bg-blue-600 border-blue-600" : "border-gray-300 bg-white"
                            }">
                              ${selected ? '<i data-lucide="check" class="w-2.5 h-2.5 text-white stroke-[3]"></i>' : ""}
                            </div>
                            <span class="${selected ? "text-blue-800 font-medium" : ""}">${b}</span>
                          </label>
                        </li>
                      `;
                      })
                      .join("")}
                  </ul>
                </div>
              `
                )
                .join("")}
            </div>
            <div class="mt-6 flex justify-between items-center">
              <button type="button" data-action="reset-bullets" class="bg-transparent text-gray-900 border-2 border-gray-900 rounded-full px-4 py-1.5 hover:text-blue-600 hover:border-blue-600 hover:scale-102 transition-all duration-200 focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 text-sm">Reset</button>
              <button type="button" data-action="next-tab" class="bg-blue-600 text-white rounded-full px-4 py-1.5 hover:bg-blue-700 hover:scale-102 transition-all duration-200 focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 text-sm">Next</button>
            </div>
          </section>
        `;
      }

      /* =========================
         WHY MODAL
         ========================= */
      function renderWhyModal() {
        if (!STATE.openWhyModal) return "";
        const id = STATE.openWhyModal;
        const iconMap = { change: "alert-triangle", now: "clock-4", recast: "sparkles" };
        const labelMap = { change: "Why Change", now: "Why Now", recast: "Why Recast" };
        const data = STATE.currentState[id];
        const headerTone = "bg-gray-50";
        const cta = id === "recast";
        return `
          <div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 animate-overlayFade" role="dialog" aria-modal="true" aria-labelledby="why-modal-title-${id}">
            <div class="w-full max-w-4xl mx-4 bg-white rounded-2xl shadow-2xl overflow-hidden animate-modalEnter" style="max-height: 95vh; overflow-y: auto;">
              <div class="${headerTone} px-6 py-4 flex items-center justify-between border-b border-gray-200">
                <div class="flex items-center gap-2">
                  <i data-lucide="${iconMap[id]}" class="w-7 h-7 text-gray-900" aria-hidden="true"></i>
                  <h2 id="why-modal-title-${id}" class="text-2xl font-bold tracking-tight text-gray-900">${labelMap[id]}</h2>
                </div>
                <button type="button" class="text-gray-500 hover:text-gray-700 focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 p-1.5" data-action="close-why-modal" aria-label="Close">
                  <i data-lucide="x" class="w-5 h-5"></i>
                </button>
              </div>
              <div class="p-6 bg-gray-50">
                <p class="text-[15px] leading-relaxed text-gray-700 mb-3">${data.intro}</p>
                <div class="space-y-3">
                  ${data.bullets
                    .map(
                      (b) => `
                    <div class="bg-white p-3 rounded-lg shadow-sm flex items-start gap-2 hover:shadow-md transition-shadow duration-300">
                      <i data-lucide="check-circle" class="w-4.5 h-4.5 text-blue-600 flex-shrink-0 mt-0.5"></i>
                      <p class="text-[15px] leading-relaxed text-gray-700">${b}</p>
                    </div>
                  `
                    )
                    .join("")}
                </div>
                <div class="mt-5 bg-white p-3 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300 flex items-start gap-2">
                  <i data-lucide="lightbulb" class="w-4.5 h-4.5 text-yellow-400 flex-shrink-0 mt-0.5"></i>
                  <p class="text-[15px] italic text-gray-700">${data.analyst}</p>
                </div>
                ${
                  cta
                    ? `
                  <div class="mt-6 flex justify-center">
                    <button type="button" data-action="advance" data-next="solution" class="inline-flex bg-blue-600 text-white text-[15px] font-semibold px-5 py-2.5 items-center gap-2 focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 shadow-md hover:shadow-lg hover:bg-blue-700 transition-shadow duration-300 rounded-full">
                      <i data-lucide="arrow-right" class="w-4.5 h-4.5"></i>
                      How Recast solves it
                    </button>
                  </div>
                `
                    : ""
                }
              </div>
            </div>
          </div>
        `;
      }

      /* =========================
         SOLUTION TAB
         ========================= */
      function popoutCard(card) {
        const expanded = STATE.openCards[card.id];
        const contentId = `card-content-${card.id}`;
        return `
          <div class="h-full flex flex-col">
            <button
              type="button"
              class="accordion-header w-full overflow-hidden ring-1 ring-gray-200 focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 transition hover:ring-gray-300 shadow-sm rounded-2xl min-h-[44px]"
              data-action="toggle-card"
              data-card="${card.id}"
              aria-expanded="${expanded}"
              aria-controls="${contentId}"
            >
              <div class="${card.bgHeader || "bg-gray-50"} px-4 py-3 flex flex-col border-b border-gray-200">
                <div class="flex justify-between items-center">
                  <div class="flex items-center gap-1.5">
                    <i data-lucide="${card.icon}" class="w-5 h-5 text-gray-900" aria-hidden="true"></i>
                    <span class="text-lg font-medium text-left tracking-normal text-gray-900">${card.title}</span>
                  </div>
                  <div class="flex items-center gap-1.5">
                    <span class="text-[13px] text-gray-700">${expanded ? "Collapse" : "Expand"}</span>
                    <i data-lucide="chevron-down" class="w-4.5 h-4.5 text-gray-600 transition-transform duration-150 ${
                      expanded ? "rotate-180" : ""
                    }" aria-hidden="true"></i>
                  </div>
                </div>
              </div>
            </button>
            <div id="${contentId}" class="accordion-content overflow-hidden border-l-4 border-blue-600 ${
          card.bgContent
        } ${expanded ? "max-h-[1200px] opacity-100 p-4" : "max-h-0 opacity-0 p-0"} transition-[max-height] duration-150 ease-[cubic-bezier(0.2,0.8,0.2,1)] transition-opacity duration-150">
              <ul class="list-disc pl-5 text-[15px] leading-relaxed space-y-2 text-gray-700 text-left">
                ${card.bullets.map((b) => `<li>${b}</li>`).join("")}
              </ul>
              ${card.timeline && onboardingMiniTimelineEnabled && expanded ? renderMiniTimeline() : ""}
              <p class="mt-3 italic text-[15px] text-gray-700">${card.closer}</p>
            </div>
          </div>
        `;
      }
      function renderMiniTimeline() {
        const phases = [
          { icon: "play-circle", label: "Kickoff" },
          { icon: "hammer", label: "Implementation" },
          { icon: "check-circle", label: "UAT" },
          { icon: "flag", label: "Launch" },
          { icon: "book-open", label: "Enablement" },
        ];
        return `
          <div class="flex items-center justify-between mt-3" aria-hidden="true">
            ${phases
              .map(
                (p, i) => `
              ${i > 0 ? '<div
